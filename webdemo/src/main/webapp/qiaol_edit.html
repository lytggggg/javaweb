<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/>
    <title>VForm Demo</title>
    <link rel="stylesheet" href="css/index.min.css"/>
    <link rel="stylesheet" href="css/render.style.css?t=20220129">
    <link rel="stylesheet" href="yemian/lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="yemian/css/public.css" media="all">
    <style type="text/css">
    </style>
</head>
<body>

<div id="app">
    <div class="layui-form layuimini-form">

        <v-form-render :form-json="formJson" :form-data="formData" :option-data="optionData" ref="vFormRef">
        </v-form-render>
        <el-button type="primary" @click="submitForm">Submit</el-button>
    </div>
</div>
    <script src="js/vue.global.min.js"></script>
    <script src="js/index.full.min.js"></script>
    <script src="js/render.umd.js?t=20220129"></script>
    <script src="yemian/lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
    <script>
        const {createApp} = Vue;
        layui.use(['form'], function () {
            var form = layui.form,
                layer = layui.layer,
                $ = layui.$;
            form.on('submit(formDemo)', function (data) {
                    alert(JSON.stringify(data.field))
                }
            );
        });

        const app = createApp({
            data() {
                return {

/*                    formJson: {
                        "widgetList": [{
                            "type": "static-text",
                            "icon": "static-text",
                            "formItemFlag": false,
                            "options": {
                                "name": "statictext111193",
                                "columnWidth": "200px",
                                "hidden": false,
                                "textContent": "单列表单",
                                "customClass": [],
                                "onCreated": "",
                                "onMounted": "",
                                "label": "static-text"
                            },
                            "id": "statictext111193"
                        }, {
                            "type": "divider",
                            "icon": "divider",
                            "formItemFlag": false,
                            "options": {
                                "name": "divider102346",
                                "label": "",
                                "columnWidth": "200px",
                                "direction": "horizontal",
                                "contentPosition": "center",
                                "hidden": false,
                                "customClass": [],
                                "onCreated": "",
                                "onMounted": ""
                            },
                            "id": "divider102346"
                        }, {
                            "type": "input",
                            "icon": "text-field",
                            "formItemFlag": true,
                            "options": {
                                "name": "qiaoliaoKaID",
                                "label": "桥梁卡号",
                                "labelAlign": "",
                                "type": "text",
                                "defaultValue": "",
                                "placeholder": "",
                                "columnWidth": "200px",
                                "size": "",
                                "labelWidth": null,
                                "labelHidden": false,
                                "readonly": false,
                                "disabled": false,
                                "hidden": false,
                                "clearable": true,
                                "showPassword": false,
                                "required": true,
                                "validation": "",
                                "validationHint": "",
                                "customClass": [],
                                "labelIconClass": null,
                                "labelIconPosition": "rear",
                                "labelTooltip": null,
                                "minLength": null,
                                "maxLength": null,
                                "showWordLimit": false,
                                "prefixIcon": "",
                                "suffixIcon": "",
                                "appendButton": false,
                                "appendButtonDisabled": false,
                                "buttonIcon": "el-icon-search",
                                "onCreated": "",
                                "onMounted": "",
                                "onInput": "",
                                "onChange": "",
                                "onFocus": "",
                                "onBlur": "",
                                "onValidate": ""
                            },
                            "id": "input12931"
                        }, {
                            "type": "input",
                            "icon": "text-field",
                            "formItemFlag": true,
                            "options": {
                                "name": "name",
                                "label": "桥梁名称",
                                "labelAlign": "",
                                "type": "text",
                                "defaultValue": "",
                                "placeholder": "",
                                "columnWidth": "200px",
                                "size": "",
                                "labelWidth": null,
                                "labelHidden": false,
                                "readonly": false,
                                "disabled": false,
                                "hidden": false,
                                "clearable": true,
                                "showPassword": false,
                                "required": true,
                                "validation": "",
                                "validationHint": "",
                                "customClass": "",
                                "labelIconClass": null,
                                "labelIconPosition": "rear",
                                "labelTooltip": null,
                                "minLength": null,
                                "maxLength": null,
                                "showWordLimit": false,
                                "prefixIcon": "",
                                "suffixIcon": "",
                                "appendButton": false,
                                "appendButtonDisabled": false,
                                "buttonIcon": "el-icon-search",
                                "onCreated": "",
                                "onMounted": "",
                                "onInput": "",
                                "onChange": "",
                                "onFocus": "",
                                "onBlur": "",
                                "onValidate": ""
                            },
                            "id": "input23031"
                        }, {
                            "type": "input",
                            "icon": "text-field",
                            "formItemFlag": true,
                            "options": {
                                "name": "place",
                                "label": "地区",
                                "labelAlign": "",
                                "type": "text",
                                "defaultValue": "",
                                "placeholder": "",
                                "columnWidth": "200px",
                                "size": "",
                                "labelWidth": null,
                                "labelHidden": false,
                                "readonly": false,
                                "disabled": false,
                                "hidden": false,
                                "clearable": true,
                                "showPassword": false,
                                "required": true,
                                "validation": "",
                                "validationHint": "",
                                "customClass": "",
                                "labelIconClass": null,
                                "labelIconPosition": "rear",
                                "labelTooltip": null,
                                "minLength": null,
                                "maxLength": null,
                                "showWordLimit": false,
                                "prefixIcon": "",
                                "suffixIcon": "",
                                "appendButton": false,
                                "appendButtonDisabled": false,
                                "buttonIcon": "el-icon-search",
                                "onCreated": "",
                                "onMounted": "",
                                "onInput": "",
                                "onChange": "",
                                "onFocus": "",
                                "onBlur": "",
                                "onValidate": ""
                            },
                            "id": "input40240"
                        }, {
                            "type": "input",
                            "icon": "text-field",
                            "formItemFlag": true,
                            "options": {
                                "name": "road_place",
                                "label": "所在路名",
                                "labelAlign": "",
                                "type": "text",
                                "defaultValue": "",
                                "placeholder": "",
                                "columnWidth": "200px",
                                "size": "",
                                "labelWidth": null,
                                "labelHidden": false,
                                "readonly": false,
                                "disabled": false,
                                "hidden": false,
                                "clearable": true,
                                "showPassword": false,
                                "required": true,
                                "validation": "",
                                "validationHint": "",
                                "customClass": "",
                                "labelIconClass": null,
                                "labelIconPosition": "rear",
                                "labelTooltip": null,
                                "minLength": null,
                                "maxLength": null,
                                "showWordLimit": false,
                                "prefixIcon": "",
                                "suffixIcon": "",
                                "appendButton": false,
                                "appendButtonDisabled": false,
                                "buttonIcon": "el-icon-search",
                                "onCreated": "",
                                "onMounted": "",
                                "onInput": "",
                                "onChange": "",
                                "onFocus": "",
                                "onBlur": "",
                                "onValidate": ""
                            },
                            "id": "input78584"
                        }, {
                            "key": 92142,
                            "type": "input",
                            "icon": "text-field",
                            "formItemFlag": true,
                            "options": {
                                "name": "kua_yue",
                                "label": "跨越",
                                "labelAlign": "",
                                "type": "text",
                                "defaultValue": "",
                                "placeholder": "",
                                "columnWidth": "200px",
                                "size": "",
                                "labelWidth": null,
                                "labelHidden": false,
                                "readonly": false,
                                "disabled": false,
                                "hidden": false,
                                "clearable": true,
                                "showPassword": false,
                                "required": false,
                                "requiredHint": "",
                                "validation": "",
                                "validationHint": "",
                                "customClass": "",
                                "labelIconClass": null,
                                "labelIconPosition": "rear",
                                "labelTooltip": null,
                                "minLength": null,
                                "maxLength": null,
                                "showWordLimit": false,
                                "prefixIcon": "",
                                "suffixIcon": "",
                                "appendButton": false,
                                "appendButtonDisabled": false,
                                "buttonIcon": "custom-search",
                                "onCreated": "",
                                "onMounted": "",
                                "onInput": "",
                                "onChange": "",
                                "onFocus": "",
                                "onBlur": "",
                                "onValidate": ""
                            },
                            "id": "input85144"
                        }, {
                            "key": 92142,
                            "type": "input",
                            "icon": "text-field",
                            "formItemFlag": true,
                            "options": {
                                "name": "deng_ji",
                                "label": "等级",
                                "labelAlign": "",
                                "type": "text",
                                "defaultValue": "",
                                "placeholder": "",
                                "columnWidth": "200px",
                                "size": "",
                                "labelWidth": null,
                                "labelHidden": false,
                                "readonly": false,
                                "disabled": false,
                                "hidden": false,
                                "clearable": true,
                                "showPassword": false,
                                "required": false,
                                "requiredHint": "",
                                "validation": "",
                                "validationHint": "",
                                "customClass": "",
                                "labelIconClass": null,
                                "labelIconPosition": "rear",
                                "labelTooltip": null,
                                "minLength": null,
                                "maxLength": null,
                                "showWordLimit": false,
                                "prefixIcon": "",
                                "suffixIcon": "",
                                "appendButton": false,
                                "appendButtonDisabled": false,
                                "buttonIcon": "custom-search",
                                "onCreated": "",
                                "onMounted": "",
                                "onInput": "",
                                "onChange": "",
                                "onFocus": "",
                                "onBlur": "",
                                "onValidate": ""
                            },
                            "id": "input42864"
                        }],
                        "formConfig": {
                            "modelName": "formData",
                            "refName": "vForm",
                            "rulesName": "rules",
                            "labelWidth": 150,
                            "labelPosition": "left",
                            "size": "",
                            "labelAlign": "label-right-align",
                            "cssCode": "",
                            "customClass": [],
                            "functions": "",
                            "layoutType": "PC",
                            "jsonVersion": 3,
                            "onFormCreated": "",
                            "onFormMounted": "",
                            "onFormDataChange": "",
                            "onFormValidate": ""
                        }
                    }*/
                    formJson: {"widgetList":[{"type":"static-text","icon":"static-text","formItemFlag":false,"options":{"name":"statictext111193","columnWidth":"200px","hidden":false,"textContent":"","customClass":[],"onCreated":"","onMounted":"","label":"static-text"},"id":"statictext111193"},{"type":"divider","icon":"divider","formItemFlag":false,"options":{"name":"divider102346","label":"","columnWidth":"200px","direction":"horizontal","contentPosition":"center","hidden":false,"customClass":[],"onCreated":"","onMounted":""},"id":"divider102346"},{"key":104164,"type":"grid","category":"container","icon":"grid","cols":[{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"qiaoliaoKaID","label":"桥梁卡号","labelAlign":"label-left-align","type":"text","defaultValue":"","placeholder":"","columnWidth":"100px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":false,"validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"el-icon-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"input12931"}],"options":{"name":"gridCol88937","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":true,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-88937"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol69727","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-69727"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"name","label":"桥梁名称","labelAlign":"label-left-align","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":false,"validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"el-icon-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"input23031"}],"options":{"name":"gridCol100940","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-100940"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol85529","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-85529"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"place","label":"地区","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":false,"validation":"","validationHint":"","customClass":"","labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"el-icon-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"input40240"}],"options":{"name":"gridCol38999","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-38999"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol30860","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-30860"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"road_place","label":"所在路名","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":false,"validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"el-icon-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"input78584"}],"options":{"name":"gridCol31837","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-31837"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol83097","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-83097"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":92142,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"kua_yue","label":"跨越","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"input85144"}],"options":{"name":"gridCol50684","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-50684"}],"options":{"name":"grid112802","hidden":false,"gutter":4,"colHeight":null,"customClass":[]},"id":"grid112802"},{"type":"grid","category":"container","icon":"grid","cols":[{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":92142,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"deng_ji","label":"等级","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"input42864"}],"options":{"name":"gridCol74783","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-74783"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol35011","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-35011"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol27520","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-27520"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol85516","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-85516"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol57639","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-57639"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol93457","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-93457"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol79328","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-79328"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol29595","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-29595"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[],"options":{"name":"gridCol59462","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":""},"id":"grid-col-59462"}],"options":{"name":"grid58973","hidden":false,"gutter":12,"colHeight":null,"customClass":""},"id":"grid58973"}],"formConfig":{"modelName":"formData","refName":"vForm","rulesName":"rules","labelWidth":67,"labelPosition":"left","size":"","labelAlign":"label-right-align","cssCode":"","customClass":[],"functions":"","layoutType":"PC","jsonVersion":3,"onFormCreated":"","onFormMounted":"","onFormDataChange":"","onFormValidate":""}},

                    formData: {},
                    optionData: {}
                }
            },
            methods: {
                submitForm: function () {
                    this.$refs.vFormRef.getFormData().then(function (formData) {
                        // Form Validation OK
                      //  alert(JSON.stringify(formData))
                        axios({
                            method: "post",
                            url: "http://localhost:8080/webdemo/updateServlet/updateServlet",
                            data: formData
                        }).then(function (resp) {
                            //alert(resp.data)
                            var iframeIndex = parent.layer.getFrameIndex(window.name);
                            parent.location.reload();
                            parent.layer.close(iframeIndex);
                        })
                    }).catch(function (error) {
                        // Form Validation Failed
                        alert(error)
                    })
                }
            },
            mounted() {
                // 页面加载完成后，发送异步请求，查询数据
                //从后端接口获取已保存的数据对象（如只显示空白表单、则跳过此步骤），并赋值给formData变量，需自行实现！！
                axios.get("http://localhost:8080/webdemo/updateServlet/select2Servlet").then(res => {
                    let newFormData = null
                    newFormData = res.data
                    this.$nextTick(() => {
                        this.$refs.vFormRef.setFormData(newFormData)
                    })
                    //从后端接口获取表单json对象，然后调用v-form-render对象的setFormJson(xxx)加载表单，需自行实现！！
                }).catch(err => {
                    //
                })

            }


        });
        app.use(ElementPlus)
        app.use(VFormRender)
        app.mount("#app");
    </script>
</body>
</html>